!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/forms"),require("@angular/common"),require("@angular/core")):"function"==typeof define&&define.amd?define("ngx-mask",["exports","@angular/forms","@angular/common","@angular/core"],t):t(e["ngx-mask"]={},e.ng.forms,e.ng.common,e.ng.core)}(this,function(e,t,r,s){"use strict";var n=new s.InjectionToken("config"),i=new s.InjectionToken("NEW_CONFIG"),a=new s.InjectionToken("INITIAL_CONFIG"),o={sufix:"",prefix:"",clearIfNotMatch:!1,showTemplate:!1,showMaskTyped:!1,dropSpecialCharacters:!0,shownMaskExpression:"",specialCharacters:["-","/","(",")",".",":"," ","+",",","@","[","]",'"',"'"],patterns:{0:{pattern:new RegExp("\\d")},9:{pattern:new RegExp("\\d"),optional:!0},A:{pattern:new RegExp("[a-zA-Z0-9]")},S:{pattern:new RegExp("[a-zA-Z]")},d:{pattern:new RegExp("\\d")},m:{pattern:new RegExp("\\d")},H:{pattern:new RegExp("\\d")},h:{pattern:new RegExp("\\d")},s:{pattern:new RegExp("\\d")}}},c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var h=function(){return(h=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function p(i,s){var n,a,o,e,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return e={next:t(0),"throw":t(1),"return":t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function r(e){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,a&&(o=2&e[0]?a["return"]:e[0]?a["throw"]||((o=a["return"])&&o.call(a),0):a.next)&&!(o=o.call(a,e[1])).done)return o;switch(a=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return c.label++,{value:e[1],done:!1};case 5:c.label++,a=e[1],e=[0];continue;case 7:e=c.ops.pop(),c.trys.pop();continue;default:if(!(o=0<(o=c.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){c=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){c.label=e[1];break}if(6===e[0]&&c.label<o[1]){c.label=o[1],o=e;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(e);break}o[2]&&c.ops.pop(),c.trys.pop();continue}e=s.call(i,c)}catch(t){e=[6,t],a=0}finally{n=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([t,e])}}}function l(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,s,n=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(i=n.next()).done;)a.push(i.value)}catch(o){s={error:o}}finally{try{i&&!i.done&&(r=n["return"])&&r.call(n)}finally{if(s)throw s.error}}return a}var u=function(){function e(e){this._config=e,this.maskExpression="",this.shownMaskExpression="",this.separator=function(e){for(var t=(e+="").split("."),r=1<t.length?"."+t[1]:"",i=t[0],s=/(\d+)(\d{3})/;s.test(i);)i=i.replace(s,"$1 $2");return i+r},this.dotSeparator=function(e){for(var t=(e+="").split(","),r=1<t.length?","+t[1]:"",i=t[0],s=/(\d+)(\d{3})/;s.test(i);)i=i.replace(s,"$1.$2");return i+r},this.comaSeparator=function(e){for(var t=(e+="").split("."),r=1<t.length?"."+t[1]:"",i=t[0],s=/(\d+)(\d{3})/;s.test(i);)i=i.replace(s,"$1,$2");return i+r},this.percentage=function(e){return 0<=Number(e)&&Number(e)<=100},this._shift=new Set,this.maskSpecialCharacters=this._config.specialCharacters,this.maskAvailablePatterns=this._config.patterns,this.clearIfNotMatch=this._config.clearIfNotMatch,this.dropSpecialCharacters=this._config.dropSpecialCharacters,this.maskSpecialCharacters=this._config.specialCharacters,this.maskAvailablePatterns=this._config.patterns,this.prefix=this._config.prefix,this.sufix=this._config.sufix}return e.prototype.applyMaskWithPattern=function(e,t){var r=l(t,2),i=r[0],s=r[1];return this.customPattern=s,this.applyMask(e,i)},e.prototype.applyMask=function(e,t,r,i){if(void 0===r&&(r=0),void 0===i&&(i=function(){}),e===undefined||null===e||t===undefined)return"";var s=0,n="",a=!1;e.slice(0,this.prefix.length)===this.prefix&&(e=e.slice(this.prefix.length,e.length));var o=e.toString().split("");if("percent"===t)(e.match("[a-z]|[A-Z]")||e.match(/[-!$%^&*()_+|~=`{}\[\]:";'<>?,\/]/))&&(e=e.substring(0,e.length-1)),n=this.percentage(e)?e:e.substring(0,e.length-1);else if("separator"===t){(e.match("[a-z]|[A-Z]")||e.match(/[!$%^&*()_+|~=`{}\[\]:";'<>?\/]/))&&(e=e.substring(0,e.length-1));var c=e.replace(/\s/g,"");s=r=(n=this.separator(c)).length+1;var h=/\*|\?/g.test(t.slice(0,s))?o.length:s;this._shift.add(h+this.prefix.length||0)}else if("dot_separator"===t){(e.match("[a-z]|[A-Z]")||e.match(/[!$%^&*()_+|~=`{}\[\]:";'<>?\/]/))&&(e=e.substring(0,e.length-1));c=e.replace(/\./g,"");s=r=(n=this.dotSeparator(c)).length+1;h=/\*|\?/g.test(t.slice(0,s))?o.length:s;this._shift.add(h+this.prefix.length||0)}else if("coma_separator"===t){(e.match("[a-z]|[A-Z]")||e.match(/[!$%^&*()_+|~=`{}\[\]:";'<>?\/]/))&&(e=e.substring(0,e.length-1));c=e.replace(/\,/g,"");s=r=(n=this.comaSeparator(c)).length+1;h=/\*|\?/g.test(t.slice(0,s))?o.length:s;this._shift.add(h+this.prefix.length||0)}else for(var p=0,l=o[0];p<o.length&&s!==t.length;l=o[++p])if(this._checkSymbolMask(l,t[s])&&"?"===t[s+1])n+=l,s+=2;else if("*"===t[s+1]&&a&&this._checkSymbolMask(l,t[s+2]))n+=l,s+=3,a=!1;else if(this._checkSymbolMask(l,t[s])&&"*"===t[s+1])n+=l,a=!0;else if("?"===t[s+1]&&this._checkSymbolMask(l,t[s+2]))n+=l,s+=3;else if(this._checkSymbolMask(l,t[s])){if("H"===t[s]&&2<Number(l)){n+=0,s+=1;h=/\*|\?/g.test(t.slice(0,s))?o.length:s;this._shift.add(h+this.prefix.length||0),p--;continue}if("h"===t[s]&&"2"===n&&3<Number(l))continue;if("m"===t[s]&&5<Number(l)){n+=0,s+=1;h=/\*|\?/g.test(t.slice(0,s))?o.length:s;this._shift.add(h+this.prefix.length||0),p--;continue}if("s"===t[s]&&5<Number(l)){n+=0,s+=1;h=/\*|\?/g.test(t.slice(0,s))?o.length:s;this._shift.add(h+this.prefix.length||0),p--;continue}n+=l,s++}else if(this._checkSymbolMask(l,t[s])){if("d"===t[s]&&3<Number(l)){n+=0,s+=1;h=/\*|\?/g.test(t.slice(0,s))?o.length:s;this._shift.add(h+this.prefix.length||0),p--;continue}if("d"===t[s-1]&&31<Number(e.slice(s-1,s+1)))continue;if("m"===t[s]&&1<Number(l)){n+=0,s+=1;h=/\*|\?/g.test(t.slice(0,s))?o.length:s;this._shift.add(h+this.prefix.length||0),p--;continue}if("m"===t[s-1]&&12<Number(e.slice(s-1,s+1)))continue;n+=l,s++}else if(-1!==this.maskSpecialCharacters.indexOf(t[s])){n+=t[s],s++;h=/\*|\?/g.test(t.slice(0,s))?o.length:s;this._shift.add(h+this.prefix.length||0),p--}else-1<this.maskSpecialCharacters.indexOf(l)&&this.maskAvailablePatterns[t[s]]&&this.maskAvailablePatterns[t[s]].optional?(s++,p--):"*"===this.maskExpression[s+1]&&this._findSpecialChar(this.maskExpression[s+2])&&this._findSpecialChar(l)===this.maskExpression[s+2]&&a&&(s+=3,n+=l);n.length+1===t.length&&-1!==this.maskSpecialCharacters.indexOf(t[t.length-1])&&(n+=t[t.length-1]);for(var u=1,f=r+1;this._shift.has(f);)u++,f++;i(this._shift.has(r)?u:0);var m=""+this.prefix+n;return m=this.sufix?""+this.prefix+n+this.sufix:""+this.prefix+n,0===n.length&&(m=""+this.prefix+n),m},e.prototype._findSpecialChar=function(t){return this.maskSpecialCharacters.find(function(e){return e===t})},e.prototype._checkSymbolMask=function(e,t){return this.maskAvailablePatterns=this.customPattern?this.customPattern:this.maskAvailablePatterns,this.maskAvailablePatterns[t]&&this.maskAvailablePatterns[t].pattern&&this.maskAvailablePatterns[t].pattern.test(e)},e.decorators=[{type:s.Injectable}],e.ctorParameters=function(){return[{type:undefined,decorators:[{type:s.Inject,args:[n]}]}]},e}(),f=function(a){function e(e,t,r,i){var s=a.call(this,t)||this;return s.document=e,s._config=t,s._elementRef=r,s._renderer=i,s.maskExpression="",s.isNumberValue=!1,s.showMaskTyped=!1,s.maskIsShown="",s.onChange=function(e){},s.onTouch=function(){},s._formElement=s._elementRef.nativeElement,s}return function i(e,t){function r(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(e,a),e.prototype.applyMask=function(e,t,r,i){if(void 0===r&&(r=0),void 0===i&&(i=function(){}),this.maskIsShown=this.showMaskTyped?this.showMaskInInput():"",!e&&this.showMaskTyped)return this.prefix+this.maskIsShown;var s=a.prototype.applyMask.call(this,e,t,r,i);Array.isArray(this.dropSpecialCharacters)?this.onChange(this._removeMask(this._removeSufix(this._removePrefix(s)),this.dropSpecialCharacters)):!0===this.dropSpecialCharacters?this.onChange(this.isNumberValue?Number(this._removeMask(this._removeSufix(this._removePrefix(s)),this.maskSpecialCharacters)):this._removeMask(this._removeSufix(this._removePrefix(s)),this.maskSpecialCharacters)):this.onChange(this._removeSufix(this._removePrefix(s)));if(!this.showMaskTyped)return s;var n=s.length;return s+(this.prefix+this.maskIsShown).slice(n)},e.prototype.applyValueChanges=function(e,t){void 0===e&&(e=0),void 0===t&&(t=function(){});var r=this.applyMask(this._formElement.value,this.maskExpression,e,t);this._formElement.value=r,this._formElement!==this.document.activeElement&&this.clearIfNotMatchFn()},e.prototype.showMaskInInput=function(){if(this.showMaskTyped&&this.shownMaskExpression){if(this.maskExpression.length!==this.shownMaskExpression.length)throw new Error("Mask expression must match mask placeholder length");return this.shownMaskExpression}return this.showMaskTyped?this.maskExpression.replace(/\w/g,"_"):""},e.prototype.clearIfNotMatchFn=function(){!0===this.clearIfNotMatch&&this.maskExpression.length!==this._formElement.value.length&&(this.formElementProperty=["value",""],this.applyMask(this._formElement.value,this.maskExpression))},Object.defineProperty(e.prototype,"formElementProperty",{set:function(e){var t=l(e,2),r=t[0],i=t[1];this._renderer.setProperty(this._formElement,r,i)},enumerable:!0,configurable:!0}),e.prototype._removeMask=function(e,t){return e?e.replace(this._regExpForRemove(t),""):e},e.prototype._removePrefix=function(e){return this.prefix&&e?e.replace(this.prefix,""):e},e.prototype._removeSufix=function(e){return this.sufix&&e?e.replace(this.sufix,""):e},e.prototype._regExpForRemove=function(e){return new RegExp(e.map(function(e){return"\\"+e}).join("|"),"gi")},e.decorators=[{type:s.Injectable}],e.ctorParameters=function(){return[{type:undefined,decorators:[{type:s.Inject,args:[r.DOCUMENT]}]},{type:undefined,decorators:[{type:s.Inject,args:[n]}]},{type:s.ElementRef},{type:s.Renderer2}]},e}(u),m=function(){function e(e,t){this.document=e,this._maskService=t,this._position=null,this.onChange=function(e){},this.onTouch=function(){}}return Object.defineProperty(e.prototype,"maskExpression",{set:function(e){this._maskValue=e||"",this._maskValue&&(this._maskService.maskExpression=this._repeatPatternSymbols(this._maskValue),this._maskService.formElementProperty=["value",this._maskService.applyMask(this._inputValue,this._maskService.maskExpression)])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"specialCharacters",{set:function(e){e&&Array.isArray(e)&&(!Array.isArray(e)||e.length)&&(this._maskService.maskSpecialCharacters=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"patterns",{set:function(e){e&&(this._maskService.maskAvailablePatterns=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"prefix",{set:function(e){e&&(this._maskService.prefix=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sufix",{set:function(e){e&&(this._maskService.sufix=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropSpecialCharacters",{set:function(e){this._maskService.dropSpecialCharacters=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showMaskTyped",{set:function(e){e&&(this._maskService.showMaskTyped=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shownMaskExpression",{set:function(e){e&&(this._maskService.shownMaskExpression=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showTemplate",{set:function(e){this._maskService.showTemplate=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clearIfNotMatch",{set:function(e){this._maskService.clearIfNotMatch=e},enumerable:!0,configurable:!0}),e.prototype.onInput=function(e){var t=e.target;if(this._inputValue=t.value,this._maskValue){var r=1===t.selectionStart?t.selectionStart+this._maskService.prefix.length:t.selectionStart,i=0;this._maskService.applyValueChanges(r,function(e){return i=e}),this.document.activeElement===t&&(t.selectionStart=t.selectionEnd=null!==this._position?this._position:r+("deleteContentBackward"===e.inputType?0:i),this._position=null)}else this.onChange(t.value)},e.prototype.onBlur=function(){this._maskService.clearIfNotMatchFn(),this.onTouch()},e.prototype.onFocus=function(e){var t=e.target;null!==t&&null!==t.selectionStart&&t.selectionStart===t.selectionEnd&&t.selectionStart>this._maskService.prefix.length&&38!==e.keyCode||(this._maskService.showMaskTyped&&(this._maskService.maskIsShown=this._maskService.showMaskInInput()),t.value=t.value&&t.value!==this._maskService.prefix?t.value:this._maskService.prefix+this._maskService.maskIsShown,(t.selectionStart||t.selectionEnd)<=this._maskService.prefix.length&&(t.selectionStart=this._maskService.prefix.length))},e.prototype.a=function(e){var t=e.target;38===e.keyCode&&e.preventDefault(),37!==e.keyCode&&8!==e.keyCode||(t.selectionStart<=this._maskService.prefix.length&&t.selectionEnd<=this._maskService.prefix.length&&e.preventDefault(),this.onFocus(e),8===e.keyCode&&0===t.selectionStart&&t.selectionEnd===t.value.length&&(t.value=this._maskService.prefix,this._position=this._maskService.prefix?this._maskService.prefix.length:1,this.onInput(e)))},e.prototype.onPaste=function(){this._position=Number.MAX_SAFE_INTEGER},e.prototype.writeValue=function(t){return function e(t,a,o,c){return new(o||(o=Promise))(function(e,r){function i(e){try{n(c.next(e))}catch(t){r(t)}}function s(e){try{n(c["throw"](e))}catch(t){r(t)}}function n(t){t.done?e(t.value):new o(function(e){e(t.value)}).then(i,s)}n((c=c.apply(t,a||[])).next())})}(this,void 0,void 0,function(){return p(this,function(e){return t===undefined&&(t=""),"number"==typeof t&&(t=String(t),this._maskService.isNumberValue=!0),t&&this._maskService.maskExpression||this._maskService.maskExpression&&(this._maskService.prefix||this._maskService.showMaskTyped)?this._maskService.formElementProperty=["value",this._maskService.applyMask(t,this._maskService.maskExpression)]:this._maskService.formElementProperty=["value",t],this._inputValue=t,[2]})})},e.prototype.registerOnChange=function(e){this.onChange=e,this._maskService.onChange=this.onChange},e.prototype.registerOnTouched=function(e){this.onTouch=e},e.prototype.setDisabledState=function(e){this._maskService.formElementProperty=["disabled",e]},e.prototype._repeatPatternSymbols=function(s){var n=this;return s.match(/{[0-9]+}/)&&s.split("").reduce(function(e,t,r){if(n._start="{"===t?r:n._start,"}"!==t)return n._maskService._findSpecialChar(t)?e+t:e;n._end=r;var i=Number(s.slice(n._start+1,n._end));return e+new Array(i+1).join(s[n._start-1])},"")||s},e.decorators=[{type:s.Directive,args:[{selector:"[mask]",providers:[{provide:t.NG_VALUE_ACCESSOR,useExisting:s.forwardRef(function(){return e}),multi:!0},f]}]}],e.ctorParameters=function(){return[{type:undefined,decorators:[{type:s.Inject,args:[r.DOCUMENT]}]},{type:f}]},e.propDecorators={maskExpression:[{type:s.Input,args:["mask"]}],specialCharacters:[{type:s.Input}],patterns:[{type:s.Input}],prefix:[{type:s.Input}],sufix:[{type:s.Input}],dropSpecialCharacters:[{type:s.Input}],showMaskTyped:[{type:s.Input}],shownMaskExpression:[{type:s.Input}],showTemplate:[{type:s.Input}],clearIfNotMatch:[{type:s.Input}],onInput:[{type:s.HostListener,args:["input",["$event"]]}],onBlur:[{type:s.HostListener,args:["blur"]}],onFocus:[{type:s.HostListener,args:["click",["$event"]]}],a:[{type:s.HostListener,args:["keydown",["$event"]]}],onPaste:[{type:s.HostListener,args:["paste"]}]},e}(),y=function(){function e(e){this._maskService=e}return e.prototype.transform=function(e,t){return e?"string"==typeof t?this._maskService.applyMask(""+e,t):this._maskService.applyMaskWithPattern(""+e,t):""},e.decorators=[{type:s.Pipe,args:[{name:"mask",pure:!0}]}],e.ctorParameters=function(){return[{type:u}]},e}(),d=function(){function t(){}return t.forRoot=function(e){return{ngModule:t,providers:[{provide:i,useValue:e},{provide:a,useValue:o},{provide:n,useFactory:k,deps:[a,i]}]}},t.forChild=function(e){return{ngModule:t}},t.decorators=[{type:s.NgModule,args:[{providers:[u],exports:[m,y],declarations:[m,y]}]}],t}();function k(e,t){return"function"==typeof t?t():h({},e,t)}e.config=n,e.NEW_CONFIG=i,e.INITIAL_CONFIG=a,e.initialConfig=o,e.MaskDirective=m,e.MaskService=f,e._configFactory=k,e.NgxMaskModule=d,e.MaskPipe=y,e.ɵa=u,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-mask.umd.min.js.map